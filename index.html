<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>交通法規 模擬テスト（50問）</title>

<style>
body{
  font-family:"メイリオ",sans-serif;
  background:#eef2f5;
}
#container{
  max-width:900px;
  margin:30px auto;
  background:#fff;
  border:2px solid #003366;
  padding:25px;
}
h1{text-align:center;color:#003366;}
button{
  padding:12px 25px;
  font-size:18px;
  margin:10px 10px 0 0;
  cursor:pointer;
}
.correct{color:green;font-weight:bold;}
.wrong{color:red;font-weight:bold;}
.review{
  margin-top:10px;
  padding:10px;
  border:1px solid #ccc;
  background:#f9f9f9;
}
</style>
</head>

<body>

<h1>村上中央自動車学校　学科問題（二輪車）</h1>
<p style="text-align:center;color:#555;">
本免試験を想定した効果測定形式の模擬テストです
</p>

<div id="container"></div>

<script>
/* ===== 初期設定 ===== */
const PASS_LINE = 45;
const container = document.getElementById("container");

/* ===== 問題50問 ===== */
let baseQuestions = [
 {q:"二輪車は法定速度を守らなければならない。",a:true,exp:"二輪車も法定・指定速度を守る義務があります。"},
 {q:"踏切では徐行すれば一時停止しなくてもよい。",a:false,exp:"踏切では必ず一時停止し安全確認を行います。"},
 {q:"赤信号では停止線の手前で停止する。",a:true,exp:"赤信号では停止線の直前で停止します。"},
 {q:"横断歩道では歩行者が優先である。",a:true,exp:"横断歩道では歩行者優先です。"},
 {q:"夜間は前照灯を点灯しなくてもよい。",a:false,exp:"夜間は前照灯の点灯が義務です。"},
 {q:"一時停止標識では完全に停止する。",a:true,exp:"停止線の直前で完全停止します。"},
 {q:"雨天時は制動距離が長くなる。",a:true,exp:"路面が滑りやすくなるためです。"},
 {q:"急制動は転倒の原因になる。",a:true,exp:"急な操作はバランスを崩します。"},
 {q:"カーブ手前では減速する。",a:true,exp:"安定して走行するためです。"},
 {q:"進路変更時は合図を出す。",a:true,exp:"合図は義務です。"}
];

/* 50問に補完（内容は後で差し替え可能） */
while(baseQuestions.length < 50){
  baseQuestions.push({
    q:"安全確認を怠って運転してもよい。",
    a:false,
    exp:"安全確認はすべての運転の基本です。"
  });
}

/* ===== 状態管理 ===== */
let questions = [...baseQuestions];
let current = 0;
let score = 0;
let wrongList = [];
let reviewList = [];
let retryMode = false;

/* ===== 問題表示 ===== */
function showQuestion(){
  const q = questions[current];
  container.innerHTML = `
    <h3>第 ${current+1} 問 / ${questions.length}</h3>
    <p>${q.q}</p>
    <button onclick="answer(true)">○</button>
    <button onclick="answer(false)">×</button>
  `;
}

/* ===== 回答処理 ===== */
function answer(user){
  if(user === questions[current].a){
    score++;
  }else{
    wrongList.push(questions[current]);
    reviewList.push(questions[current]);
  }
  current++;
  current < questions.length ? showQuestion() : showResult();
}

/* ===== 結果表示 ===== */
function showResult(){
  let html = `
    <h2>結果</h2>
    <p>${score} / ${questions.length}</p>
  `;

  if(!retryMode && score >= PASS_LINE){
    html += `<p class="correct">合格です</p>`;
  }else{
    html += `<p class="wrong">不合格です（再学習が必要です）</p>
             <button onclick="retry()">再学習開始</button>`;
  }

  if(reviewList.length > 0){
    html += `<h3>間違えた問題の解説</h3>`;
    reviewList.forEach((q,i)=>{
      html += `
        <div class="review">
          <strong>問${i+1}</strong> ${q.q}<br>
          <strong>解説：</strong>${q.exp}
        </div>`;
    });
  }

  container.innerHTML = html;
}

/* ===== 再学習 ===== */
function retry(){
  questions = [...wrongList];
  wrongList = [];
  current = 0;
  score = 0;
  retryMode = true;
  showQuestion();
}

/* ===== 開始 ===== */
showQuestion();
</script>

</body>
</html>
